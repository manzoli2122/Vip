<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                template="/resources/templates/default/decorator.xhtml">
    
    <ui:define name="body">
    	
    	<h2 style="text-align:center;">
            <h:outputText value="#{msgsSalao['manageSalario.title.create']}" rendered="#{(! manageSalarioController.readOnly) and (manageSalarioController.selectedEntity.id == null)}" />
            <h:outputText value="#{msgsSalao['manageSalario.title.update']}" rendered="#{(! manageSalarioController.readOnly) and (manageSalarioController.selectedEntity.id != null)}" />
            <h:outputText value="#{msgsSalao['manageSalario.title.retrieve']}" rendered="#{manageSalarioController.readOnly}" />
        </h2> 
        
    	<h:form id="form">
 
    					<h:panelGroup id="funcionarioField">
							<ui:decorate template="/resources/templates/default/formfield.xhtml">
								<ui:param name="fieldName" value="form:funcionario" />
								<p:selectOneMenu id="funcionario" value="#{manageSalarioController.selectedEntity.funcionario}" converter="#{coreController.userConverter}" required="true" disabled="#{manageSalarioController.readOnly}">
									<f:selectItem itemLabel="#{msgsSalao['manageSalario.form.funcionario.blankOption']}" itemValue="" />
									<f:selectItems value="#{coreController.funcionarios}" var="func" itemLabel="#{func.name}" itemValue="#{func}" />
									<p:ajax  update=":main:form" listener="#{manageSalarioController.buscarServicos()}" />
								</p:selectOneMenu>
							</ui:decorate>
						</h:panelGroup>
						
						
						
						
						<h:panelGroup id="servicosField" rendered="#{!manageSalarioController.selectedEntity.servicos.isEmpty()}" >
								<div style="clear: both;">&nbsp;</div> 
								<p:separator/>	
								<h4 style="text-align:center;"><h:outputText value="#{msgsSalao['manageSalario.form.servicos']}" /></h4>
								<p:dataTable 
										rowIndexVar="rowIndex"
										id="servicos"
										value="#{manageSalarioController.selectedEntity.servicos}" 
										var="servico"
										tableStyleClass ="tabela" 
										disabledSelection="true"
										rowKey="#{servico.uuid}" 
										loadingMessage="#{msgsSalao['text.ajax.loading']}" 
										emptyMessage="#{msgsSalao['manageSalario.text.noServicos']}">
										
									
								    <p:column  style="text-align:center">
										<h:outputText value="#{servico.atendimento.createDate}" >
											<f:convertDateTime type="date" pattern="#{msgsSalao['format.date.java']}" locale="pt_BR" timeZone="America/Sao_Paulo"/>
										</h:outputText>
									</p:column>
									
									<p:column style="text-align:center" >
										<h:outputText value="#{servico.servico.name}" />
									</p:column>
									
									<p:column   style="text-align:center" >
										<h:outputText value=" R$ " /><h:outputText value="#{servico.comissao}" >
											<f:convertNumber pattern="0.00" />
										</h:outputText>
									</p:column>
					
								</p:dataTable>
								<div style="clear: both;">&nbsp;</div>
						</h:panelGroup>
						
						
						
						 
						
						<h:panelGroup id="valesField"  rendered="#{!manageSalarioController.selectedEntity.vales.isEmpty()}">	
								<div style="clear: both;">&nbsp;</div>
								<p:separator/>
								<h4 style="text-align:center;"> <h:outputText  value="#{msgsSalao['manageSalario.form.vales']}" />	</h4>
								<p:dataTable 
										rowIndexVar="rowIndex"
										id="vales"
										value="#{manageSalarioController.selectedEntity.vales}" 
										var="vale"
										tableStyleClass ="tabela" 
										disabledSelection="true"
										rowKey="#{vale.uuid}" 
										loadingMessage="#{msgsSalao['text.ajax.loading']}" 
										emptyMessage="#{msgsSalao['manageSalario.text.noVales']}">
										
								    <p:column  style="text-align:center">
										<h:outputText value="#{vale.createDate}" >
											<f:convertDateTime type="date" pattern="#{msgsSalao['format.date.java']}" locale="pt_BR" timeZone="America/Sao_Paulo"/>
										</h:outputText>
									</p:column>
									
									<p:column  style="text-align:center" >
										<h:outputText value=" R$ " /><h:outputText value="#{vale.valor}" >
											<f:convertNumber pattern="0.00" />
										</h:outputText>
									</p:column>
					
								</p:dataTable>
								<div style="clear: both;">&nbsp;</div>
						</h:panelGroup>
    					
    					
    					
    					
    					<div style="clear: both;">&nbsp;</div> 
    					<p:separator/>
						<div style="clear: both;">&nbsp;</div> 
    
    					<h:panelGroup >
							<h:outputText value=" Total Serviços : "/>
							<h:outputText value="#{manageSalarioController.selectedEntity.calcularServicos()}">
								<f:convertNumber pattern="R$ 0.00" />
							</h:outputText>
						</h:panelGroup>
    
    					<div style="clear: both;">&nbsp;</div> 
    
    					<h:panelGroup>
							<h:outputText value=" Total Vales : "/>
							<h:outputText value="#{manageSalarioController.selectedEntity.calcularVales()}">
								<f:convertNumber pattern="R$ 0.00" />
							</h:outputText>
						</h:panelGroup>
														
    					<div style="clear: both;">&nbsp;</div> 
    					<p:separator/>
						<div style="clear: both;">&nbsp;</div> 
    
    					<h:panelGroup>
							<h:outputText value=" Salário Total : "/>
							<h:outputText value="#{manageSalarioController.selectedEntity.valor}">
								<f:convertNumber pattern="R$ 0.00" />
							</h:outputText>
						</h:panelGroup>
    					
    					<div style="clear: both;">&nbsp;</div> 
    					<div style="clear: both;">&nbsp;</div> 
    					    
        
                    	<h:panelGroup rendered="#{! manageSalarioController.readOnly}">
                            <p:commandButton styleClass="botaoMenu ui-btn ui-shadow ui-corner-all ui-btn-icon-left ui-icon-back" action="#{manageSalarioController.list}" value="#{msgsSalao['crud.button.cancel']}" immediate="true" icon="buttonCancel" />
                            <p:commandButton styleClass="botaoMenu ui-btn ui-shadow ui-corner-all ui-btn-icon-left ui-icon-check" action="#{manageSalarioController.save}" value="#{msgsSalao['crud.button.save']}" icon="buttonOk" update=":main:form :main:globalMessages" />
                        </h:panelGroup>
                        
                        <h:panelGroup rendered="#{manageSalarioController.readOnly}">
                            <p:commandButton styleClass="botaoMenu ui-btn ui-shadow ui-corner-all ui-btn-icon-left ui-icon-back" action="#{manageSalarioController.list}" value="#{msgsSalao['crud.button.back']}" immediate="true" icon="buttonBack" />
                        	<p:commandButton styleClass="botaoCancelarFiltro ui-btn ui-shadow ui-corner-all ui-btn-icon-left ui-icon-delete" action="#{manageSalarioController.trash}" value="#{msgsSalao['crud.button.delete']}" icon="buttonTrash" disabled="#{manageSalarioController.selectedEntity == null}" process="@this" update=":main:trashForm :main:globalMessages" />
                
                        </h:panelGroup>
                   
                </h:form>
                
                
            <h:form id="trashForm">
                <p:panel id="trashPanel" styleClass="trashPanel" header="#{msgsSalao['crud.text.trashHeader']}" toggleable="true" rendered="#{not empty manageSalarioController.trashCan}">
                    <p:dataList value="#{manageSalarioController.trashCan}" var="entity" type="unordered">
                        #{entity.createDate} , #{entity.funcionario.name}
                    </p:dataList>
                    
                    <p:commandButton styleClass="botaoMenu ui-btn ui-shadow ui-corner-all ui-btn-icon-left ui-icon-back" action="#{manageSalarioController.cancelDeletion}" value="#{msgsSalao['crud.button.cancelDeletion']}" icon="buttonCancel" update=":main:trashForm" />
                    <p:commandButton styleClass="botaoMenu ui-btn ui-shadow ui-corner-all ui-btn-icon-left ui-icon-check" action="#{manageSalarioController.delete}" value="#{msgsSalao['crud.button.confirmDeletion']}" icon="buttonOk" />
                    
                </p:panel>
            </h:form>
           
    </ui:define>  
    
    <ui:define name="help">
    
    	<p> Passos para Cadastrar um Salario:</p>
    	
    	<p>
    		 → Apenas selecione o Funcinário, será buscado os atendimentos que o funcionario fez e os seus 
    		 vales e será calculado o valor do salário.
		</p>
			
    </ui:define>
      
</ui:composition>